<!DOCTYPE html>
<html>
<head>
  <title>MEMORIA VISIVA Associazione volto-nome LIV. 2</title>
  <meta charset="UTF-8" />

  <script src="./jspsych7.2.3/dist/jspsych.js"></script>
  <script src="./jspsych7.2.3/dist/plugin-html-button-response.js"></script>
  <script src="./jspsych7.2.3/dist/plugin-image-button-response.js"></script>
  <script src="./jspsych7.2.3/dist/plugin-preload.js"></script>
  <script src="./jspsych7.2.3/dist/plugin-survey-text.js"></script>
  <script src="./jspsych7.2.3/dist/plugin-html-keyboard-response.js"></script>


  <link href="./jspsych7.2.3/dist/jspsych.css" rel="stylesheet" type="text/css" />
  <script src="jatos.js"></script>

</head>
<body>
  <style>
  body {
    background-color: white;
  }

  </style>

  <!--
  “Ora vedrai dei passaporti di persone, con alcune informazioni.
  Il suo compito è quello di memorizzarle.
  Le verrà chiesto di scrivere quali informazioni erano riportate sul passaporto.”
  Per livello 2 e 3, sotto: “ATTENZIONE: prima di rispondere verrà distratto da un altro breve compito, quindi tenga bene a mente le informazioni!”
  vengono presentati dei volti di cui bisogna ricordare il nome ed il cognome.
  creare “passaporti” con immagine volti. di fianco vengono riportare le informazioni
  SECONDO LIVELLO:
  5 trials. Interferenza = calcoli, pallini/stelline/figure da contare a inserimento del numero, suoni da contare.
  si presenta 1 persona con nome + professione + città. il partecipante deve riportare le informazioni
  bottone per andare avanti (senza limiti di tempo per l’elaborazione)

-->
</body>
<script>

/* to initialize jspsych */
var jsPsych = initJsPsych({
  use_webaudio: false,

  on_finish: function() {
    /*jsPsych.data.displayData();*/ //lascio così adesso in via di sviluppo

    var feed;
    if(punteggio >= 4){ //affinché si passi l'esercizio con l'80% delle risposte corrette
      var feed = 1;
    } else {
      var feed = -1;
    }
    var punteggio_dec = punteggio*10/5;
    jatos.studySessionData = feed;
    var memoria_visiva = Number(sessionStorage.getItem('memoria_visiva'))+feed;
    var counter_memoria_visiva = Number(sessionStorage.getItem('counter_memoria_visiva'))+1;
    var punteggio_finale_memoria_visiva= Number(sessionStorage.getItem('punteggio_finale_memoria_visiva'))+punteggio_dec;
    sessionStorage.setItem('punteggio_finale_memoria_visiva', punteggio_finale_memoria_visiva);
    if (memoria_visiva < 0) {memoria_visiva = 0}
    if (memoria_visiva > 2) {memoria_visiva = 2}
    if (counter_memoria_visiva > 3) {counter_memoria_visiva = 3}
    sessionStorage.setItem('memoria_visiva', memoria_visiva);
    sessionStorage.setItem('counter_memoria_visiva', counter_memoria_visiva);
    var Data = {feed: feed, type: 'MEMORIA_VISIVA_associazionevoltonome_level2', cresp: punteggio_dec};
    jatos.startComponentByPos(4,Data);

  }

});



var preload = {
  type: jsPsychPreload,
  images: [
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/1.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/2.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/3.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/4.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/5.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/6.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/7.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/8.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/9.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/10.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/11.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/12.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/13.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/14.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/15.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/16.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/17.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/18.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/19.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/20.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/21.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/22.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/23.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/24.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/25.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/26.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/27.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/28.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/29.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/30.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/31.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/32.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/33.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/34.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/35.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/36.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/37.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/38.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/39.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/40.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/41.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/42.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/43.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/44.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/45.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/46.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/47.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/48.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/49.jpg',
    './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/50.jpg'
  ]
};
var array_imgs = [
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/1.jpg', nome: 'daniele', professione: 'pescatore', città: 'udine' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/2.jpg', nome: 'sara', professione: 'pittrice', città: 'pordenone' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/3.jpg', nome: 'marco', professione: 'informatico', città: 'trieste' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/4.jpg', nome: 'vittorio', professione: 'bidello', città: 'lucca' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/5.jpg', nome: 'angelo', professione: 'tennista', città: 'belluno' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/6.jpg', nome: 'monica', professione: 'sarta', città: 'ancona' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/7.jpg', nome: 'serena', professione: 'astronoma', città: 'chieti' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/8.jpg', nome: 'massimo', professione: 'bibliotecario', città: 'bari' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/9.jpg', nome: 'michele', professione: 'elettricista', città: 'foggia' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/10.jpg', nome: 'adriano', professione: 'fotografo', città: 'savona' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/11.jpg', nome: 'pasquale', professione: 'giardiniere', città: 'milano' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/12.jpg', nome: 'riccardo', professione: 'matematico', città: 'brescia' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/13.jpg', nome: 'gabriele', professione: 'scrittore', città: 'bergamo' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/14.jpg', nome: 'elisa', professione: 'maestra', città: 'como' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/15.jpg', nome: 'mara', professione: 'viaggiatrice', città: 'pavia' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/16.jpg', nome: 'emanuele', professione: 'cuoco', città: 'roma' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/17.jpg', nome: 'francesco', professione: 'ballerino', città: 'latina' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/18.jpg', nome: 'eleonora', professione: 'musicista', città: 'frosinone' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/19.jpg', nome: 'maria', professione: 'volontaria', città: 'viterbo' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/20.jpg', nome: 'francesca', professione: 'contadina', città: 'rieti' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/21.jpg', nome: 'silvia', professione: 'ingegnere', città: 'napoli' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/22.jpg', nome: 'giulia', professione: 'guida turistica', città: 'salerno' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/23.jpg', nome: 'giuseppe', professione: 'ciclista', città: 'caserta' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/24.jpg', nome: 'carlo', professione: 'calciatore', città: 'benevento' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/25.jpg', nome: 'giorgia', professione: 'pianista', città: 'avellino' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/26.jpg', nome: 'leonardo', professione: 'alpinista', città: 'palermo' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/27.jpg', nome: 'alice', professione: 'nuotatrice', città: 'catania' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/28.jpg', nome: 'emma', professione: 'ricamatrice', città: 'messina' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/29.jpg', nome: 'aurora', professione: 'illustratrice', città: 'siracusa' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/30.jpg', nome: 'lucia', professione: 'cantante', città: 'trapani' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/31.jpg', nome: 'angela', professione: 'illusionista', città: 'venezia' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/32.jpg', nome: 'rita', professione: 'stilista', città: 'verona' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/33.jpg', nome: 'bianca', professione: 'golfista', città: 'padova' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/34.jpg', nome: 'adele', professione: 'artigiana', città: 'vicenza' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/35.jpg', nome: 'vincenzo', professione: 'operaio', città: 'treviso' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/36.jpg', nome: 'giulio', professione: 'velista', città: 'torino' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/37.jpg', nome: 'mario', professione: 'gioielliere', città: 'alessandria' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/38.jpg', nome: 'daniele', professione: 'attore', città: 'asti' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/39.jpg', nome: 'margherita', professione: 'pallavolista', città: 'novara' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/40.jpg', nome: 'filippo', professione: 'barista', città: 'cuneo' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/41.jpg', nome: 'tommaso', professione: 'veterinario', città: 'bologna' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/42.jpg', nome: 'mattia', professione: 'regista', città: 'modena' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/43.jpg', nome: 'sofia', professione: 'pattinatrice', città: 'parma' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/44.jpg', nome: 'alessandro', professione: 'idraulico', città: 'rimini' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/45.jpg', nome: 'nicola', professione: 'violinista', città: 'ferrara' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/46.jpg', nome: 'marta', professione: 'modella', città: 'firenze' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/47.jpg', nome: 'anna', professione: 'dottoressa', città: 'pisa' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/48.jpg', nome: 'ester', professione: 'studentessa', città: 'livorno' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/49.jpg', nome: 'luca', professione: 'falegname', città: 'siena' },
      { img: './TASKS/MEMORIA_VISIVA/riconoscimento_volto_nome/img_persone/50.jpg', nome: 'simona', professione: 'pasticcera', città: 'prato' }
];
var imgs = jsPsych.randomization.shuffle(array_imgs);
var pre_if = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `<p style="font-size: 34px;line-height: 1.5;"> <strong> Ora vedrai delle foto di persone, con alcune informazioni. <br>
  Il suo compito è quello di memorizzarle. </strong> <br> <br> Quando è pronto, Premi il pulsante per fare una prova o per proseguire direttamente con il compito. <br>
  Le verrà chiesto di scrivere quali informazioni erano riportate nell'immagine vista. </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: blue; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>','<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['Premi qui per iniziare', 'Premi qui per fare una prova'],
  on_finish: function(data){
    if(data.response == 1){
      var risposta_prova = 1;
    } else{
      var risposta_prova = 0;
    }
    data.risposta_prova = risposta_prova
  }
};

var prova_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[0].img+'',
  stimulus_height: 600,
  // da definire dimensioni immagine
  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[0].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[0].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[0].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference_prova = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'> 12 : 4 </p>", required: true}
  ],
  preamble: "<p style='font-size: 34px; font-weight: bold;'>Riporti il risultato della seguente operazione matematica:</p>",
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    if (data.response.Q0 == "3" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }

  // -----> ci interessa che il risultato sia giusto o sbagliato?
};

var prova_answer = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();

    var nome = (imgs[0] && imgs[0].nome) ? imgs[0].nome.toLowerCase() : '';
    var professione = (imgs[0] && imgs[1].professione) ? imgs[0].professione.toLowerCase() : '';
    var città = (imgs[0] && imgs[0].città) ? imgs[0].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
    data.accuracy_nome = accuracy_nome;
    data.accuracy_professione = accuracy_professione;
  }
};

var feedback = {
  type: jsPsychHtmlKeyboardResponse,
  choices: "NO_KEYS",
  trial_duration: 1500,
  data:"",
  stimulus: "",
  on_start: function(prova_answer){
    var last_response_accuracy_nome = jsPsych.data.getLastTrialData().values()[0].accuracy_nome;
    var last_response_accuracy_professione = jsPsych.data.getLastTrialData().values()[0].accuracy_professione;
    var last_response_accuracy_città = jsPsych.data.getLastTrialData().values()[0].accuracy_città;
    if (last_response_accuracy_nome == true, last_response_accuracy_professione == true, last_response_accuracy_città == true) {
      var feedback = "<img src='feedback/img/corretto.png' width='300'></img>";
      console.log("Corretto")
    } else {
      var feedback = "<img src='feedback/img/sbagliato.png' width='300'></img>";
      console.log("Sbagliato")
    };
    var feedback_prova_stima = "<div style='font-size:60px'><b>" + feedback +"</b></div>";
    prova_answer.data = {stimulus: feedback};
    prova_answer.stimulus = feedback_prova_stima;
  }
};

var prova_loop = {
  timeline: [prova_img, interference_prova, prova_answer, feedback],
};

var begin_trial = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `<p style="font-size: 34px;line-height: 1.5; "> Allora proseguiamo, inziamo con l'esercizio. <br> <strong> Ora vedrai delle foto di persone, con alcune informazioni. <br>
  Il suo compito è quello di memorizzarle. </strong><br> <br> Quando è pronto, Premi il pulsante per proseguire direttamente con il compito. <br>
  Le verrà chiesto di scrivere quali informazioni erano riportate nell'immagine vista.
  <br> <br> ATTENZIONE: prima di rispondere verrà distratto da un altro breve compito, quindi tenga bene a mente le informazioni! </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['Premi qui per iniziare']
};

///////////////////////// TRIALS //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

let punteggio = 0; //aggiorna punteggio


var trial1_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[1].img+'',
  stimulus_height: 600,
  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[1].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[1].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[1].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference1 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'> 24 : 8 </p>", required: true}
  ],
  preamble: "<p style='font-size: 34px; font-weight: bold;'>Riporti il risultato della seguente operazione matematica:</p>",
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    if (data.response.Q0 == "3" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }
};

var trial1 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();

    var nome = (imgs[1] && imgs[1].nome) ? imgs[1].nome.toLowerCase() : '';
    var professione = (imgs[1] && imgs[1].professione) ? imgs[1].professione.toLowerCase() : '';
    var città = (imgs[1] && imgs[1].città) ? imgs[1].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
    data.accuracy_nome = accuracy_nome;
    data.accuracy_professione = accuracy_professione;

      if (data.accuracy_nome, data.accuracy_professione, data.accuracy_città == true) {
          var correct = true;
      } else {
          var correct = false;
      };
      console.log(correct);
      data.correct = correct;
      if (data.correct == true) {
        punteggio++;
        console.log('risposta corretta', punteggio);

      } else {

        console.log('risposta sbagliata', punteggio);

      }
  }
};


var trial2_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[2].img+'',
  stimulus_height: 600,

  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[2].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[2].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[2].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference2 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'> 15 x 2 </p>", required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  preamble: "<p style='font-size: 34px; font-weight: bold;'> Riporti il risultato della seguente operazione matematica:</p>",
  on_finish: function(data){
    if (data.response.Q0 == "30" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }
};

var trial2 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();

    var nome = (imgs[2] && imgs[2].nome) ? imgs[2].nome.toLowerCase() : '';
    var professione = (imgs[2] && imgs[2].professione) ? imgs[2].professione.toLowerCase() : '';
    var città = (imgs[2] && imgs[2].città) ? imgs[2].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
    data.accuracy_nome = accuracy_nome;
    data.accuracy_professione = accuracy_professione;

      if (data.accuracy_nome, data.accuracy_professione, data.accuracy_città == true) {
          var correct = true;
      } else {
          var correct = false;
      };
      console.log(correct);
      data.correct = correct;
      if (data.correct == true) {
        punteggio++;
        console.log('risposta corretta', punteggio);

      } else {

        console.log('risposta sbagliata', punteggio);

      }
  }
};


var trial3_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[3].img+'',
  stimulus_height: 600,
  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[3].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[3].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[3].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference3 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'>14 + 7</p>", required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  preamble: "<p style='font-size: 34px; font-weight: bold;'>Riporti il risultato della seguente operazione matematica:</p>",
  on_finish: function(data){
    if (data.response.Q0 == "21" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }
};

var trial3 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();

    var nome = (imgs[3] && imgs[3].nome) ? imgs[3].nome.toLowerCase() : '';
    var professione = (imgs[3] && imgs[3].professione) ? imgs[3].professione.toLowerCase() : '';
    var città = (imgs[3] && imgs[3].città) ? imgs[3].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
    data.accuracy_nome = accuracy_nome;
    data.accuracy_professione = accuracy_professione;
    if (data.accuracy_nome, data.accuracy_professione, data.accuracy_città == true) {
        var correct = true;
    } else {
        var correct = false;
    };
    console.log(correct);
    data.correct = correct;
    if (data.correct == true) {
      punteggio++;
      console.log('risposta corretta', punteggio);
    } else {

      console.log('risposta sbagliata', punteggio);

    }
  }
};


var trial4_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[4].img+'',
  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[4].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[4].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[4].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference4 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'>8 + 9</p>", required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  preamble: "<p style='font-size: 34px; font-weight: bold;'>Riporti il risultato della seguente operazione matematica:</p>",
  on_finish: function(data){
    if (data.response.Q0 == "17" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }
};

var trial4 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();

    var nome = (imgs[4] && imgs[4].nome) ? imgs[4].nome.toLowerCase() : '';
    var professione = (imgs[4] && imgs[4].professione) ? imgs[4].professione.toLowerCase() : '';
    var città = (imgs[4] && imgs[4].città) ? imgs[4].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
      data.accuracy_nome = accuracy_nome;
      data.accuracy_professione = accuracy_professione;
      if (data.accuracy_nome, data.accuracy_professione, data.accuracy_città == true) {
          var correct = true;
      } else {
          var correct = false;
      };
      console.log(correct);
      data.correct = correct;
      if (data.correct == true) {
        punteggio++;
        console.log('risposta corretta', punteggio);

      } else {

        console.log('risposta sbagliata', punteggio);

      }
  }
};

var trial5_img = {
  type: jsPsychImageButtonResponse,
  stimulus: ''+imgs[5].img+'',
  stimulus_height: 600,
  prompt: `<p style="font-size: 34px; font-weight: bold;">NOME: <a style="font-size: 45px; font-weight: lighter; font-style: italic ; color: #2540E6 ">`+ imgs[5].nome + `</a> ;
  PROFESSIONE: <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[5].professione + ` </a> ;
  CITTA':  <a style="font-size: 45px; font-weight: lighter; font-style: italic; color: #2540E6"> `+ imgs[5].città + ` </a> </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['PREMI QUI QUANDO HAI MEMORIZZATO'],
};

var interference5 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt: "<p style='font-size: 50px; font-weight: bold;'>19 - 5</p>", required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  preamble: "<p style='font-size: 34px; font-weight: bold;'>Riporti il risultato della seguente operazione matematica:</p>",
  on_finish: function(data){
    if (data.response.Q0 == "14" ){
      return console.log("Risposta corretta")
    } else {
      return console.log("Risposta sbagliata")
    }
  }
};

var trial5 = {
  type: jsPsychSurveyText,
  questions: [
    {prompt:'Qual è il nome della persona appena vista?', placeholder: 'basta soltanto il nome', name: 'Nome', required: true},
    {prompt:'Qual è la professione della persona appena vista?', name: 'Professione', required: true},
    {prompt:'Qual è la città di provenienza della persona appena vista?', name: 'Città', required: true}
  ],
  button_label: [`INVIA RISPOSTA"jspsych-btn custom-button"; style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;</button>`],

  on_finish: function(data){
    var response_nome = data.response.Nome.toLowerCase();
    var response_professione = data.response.Professione.toLowerCase();
    var response_città = data.response.Città.toLowerCase();
    var nome = (imgs[5] && imgs[5].nome) ? imgs[5].nome.toLowerCase() : '';
    var professione = (imgs[5] && imgs[5].professione) ? imgs[5].professione.toLowerCase() : '';
    var città = (imgs[5] && imgs[5].città) ? imgs[5].città.toLowerCase() : '';

    if (nome && response_nome.substring(0, 3) === nome.substring(0, 3)) {
      var accuracy_nome = true
    } else {
      var accuracy_nome = false
    }
    if (nome && response_professione.substring(0, 3) === professione.substring(0, 3)) {
      var accuracy_professione = true
    } else {
      var accuracy_professione = false
    }
    if (città && response_città.substring(0, 3) === città.substring(0, 3)) {
      var accuracy_città = true
    } else {
      var accuracy_città = false
    }
    data.accuracy_città = accuracy_città;
      data.accuracy_nome = accuracy_nome;
      data.accuracy_professione = accuracy_professione;
      if (data.accuracy_nome, data.accuracy_professione, data.accuracy_città == true) {
          var correct = true;
      } else {
          var correct = false;
      };
      console.log(correct);
      data.correct = correct;
      if (data.correct == true) {
        punteggio++;
        console.log('risposta corretta', punteggio);

      } else {

        console.log('risposta sbagliata', punteggio);

      }
  }
};






var trial_timeline = {
  timeline: [trial1_img, interference1, trial1, trial2_img, interference2, trial2, trial3_img, interference3, trial3, trial4_img, interference4, trial4, trial5_img, interference5, trial5 ]
};

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var if_node = {
  timeline: [begin_trial,trial_timeline],
  conditional_function: function(){
    var response_button = jsPsych.data.get().last(1).values()[0].risposta_prova;
    if (response_button == 0){
      console.log("prosegui a esercizio");
      return true;
    } else {
      console.log("inizia la prova");
      jsPsych.addNodeToEndOfTimeline(loop_prova)
      return false;
    }
  }
};

var begin_loop = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `<p style="font-size: 34px; line-height: 1.5;"> Va bene facciamo una prova! <br> <strong> Ora vedrai delle foto di persone, con alcune informazioni. <br>
  Il suo compito è quello di memorizzarle. </strong> <br> <br> Quando è pronto, Premi il pulsante per proseguire direttamente con il compito. <br>
  Le verrà chiesto di scrivere quali informazioni erano riportate nell'immagine vista; le raccomandiamo di scrivere tutto in corsivo. </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['Premi qui per iniziare la prova'],
  on_start: function(data){
    var response_button = jsPsych.data.get().last(1).values()[0].response;
    console.log(response_button)
    if (response_button == 0){
      console.log("salta loop");
      jsPsych.endCurrentTimeline(); /*Ends the current timeline. If timelines are nested, then only the timeline that contains the current trial is ended.*/
    }
  }
};

var end_loop_prova = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `<p style="font-size: 34px;line-height: 1.5; "> Ora che ha terminato la prova, inziamo con il vero esercizio. <br> <strong> Ora vedrai delle foto di persone, con alcune informazioni. <br>
  Il suo compito è quello di memorizzarle. </strong> <br> <br> Quando è pronto, Premi il pulsante per proseguire direttamente con il compito. <br>
  Le verrà chiesto di scrivere quali informazioni erano riportate nell'immagine vista; le raccomandiamo di scrivere tutto in corsivo.
  <br> <br> ATTENZIONE: prima di rispondere verrà distratto da un altro breve compito, quindi tenga bene a mente le informazioni! </p>`,
  button_html:['<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: blue; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>','<button class="jspsych-btn" style="font-size: 20px; color: white; background-color: green; padding: 10px 20px; border: none; border-radius: 5px;">%choice%</button>'],
  choices: ['Premi qui per iniziare', 'Premi qui per fare una prova'],
  on_finish: function(data){
    if(data.response == 1){
      var risposta = 1;
    } else{
      var risposta = 0;
      console.log("Termine loop prova");
      jsPsych.addNodeToEndOfTimeline(trial_timeline);
    }
    data.risposta_loop = risposta
  }
};

var loop_prova = {
  timeline: [begin_loop, prova_loop, end_loop_prova],
  loop_function: function(){
    var response_button = jsPsych.data.get().last(1).values()[0].risposta_loop;
    if (response_button == 1){
      return true;
    } else {
      return false; /*IMPORTANTE: mantenere l'ordine in cui sono stati inseriti gli elementi*/
    }
  }
};




var timeline = [preload,pre_if, if_node];
jsPsych.run(timeline);
</script>
</html>
